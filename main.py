from dotenv import load_dotenv
load_dotenv()
from Helpers.Logger import get_logger
import asyncio
from IngestionWorker.Services.OtoDomScrapper import OtoDomScrapper
from DataCleaner.DataCleaner import DataCleaner

async def main():
    try:
        # scrapper = OtoDomScrapper()
        # scrapped_data = await scrapper.start()
        scrapped_data = [{'data': {'price': '831 000 zł', 'price_m2': '18 467 zł/m²', 'address': 'Kleparz, Stare Miasto, Kraków, małopolskie', 'offerType': 'Oferta prywatna', 'description': 'Wyobraź sobie, że mieszkasz w samym sercu Krakowa – kilka kroków od Dworca Głównego, tuż obok tętniącego życiem Starego Miasta, a jednocześnie w miejscu, gdzie możesz złapać oddech i poczuć klimat dawnej krakowskiej kamienicy. To właśnie tutaj, przy ul. Kolberga 12, czeka na Ciebie mieszkanie, które łączy nowoczesność z historią.Wnętrze, które pachnie nowościąMieszkanie jest świeżo po remoncie i odświeżeniu – pachnie nowymi meblami i gotowe jest, by ktoś od razu się wprowadził.Oddzielna sypialnia – idealna na spokojny sen,Przytulny salon z narożnikiem, który po rozłożeniu zamienia się w dodatkowe miejsce do spania,Salon połączony z funkcjonalnym aneksem kuchennym, gdzie przygotujesz poranną kawę albo kolację dla przyjaciół,Łazienka i toaleta – osobne pomieszczenia, co w codziennym życiu okazuje się bezcenne,Dwie pojemne szafy, które pomieszczą wszystko, co chcesz ukryć przed światem.Gotowe do życiapłyta grzewcza, lodówka, okap, czajnik elektryczny,nowa pralka,pełne wyposażenie kuchni – od talerzy po garnki i sztućce,ogrzewanie? Oryginalne piece kaflowe z grzałkami – klimat dawnych wnętrz, ale w praktycznej wersji XXI wieku.Lokalizacja, która mówi sama za siebie5 minut spacerem do Dworca Głównego i Galerii Krakowskiej,kilka chwil i jesteś na Rynku Głównym,pełna komunikacja miejska – tramwaje i autobusy na wyciągnięcie ręki,w pobliżu sklepy, kawiarnie, restauracje i wszystko, czego potrzebujesz na co dzień,bliskość uczelni (UJ, Politechnika, UEK) – świetna opcja także pod inwestycję,Planty, parki i Bulwary Wiślane – idealne, żeby złapać balans między miejskim rytmem a chwilą oddechu.Dlaczego warto?Bo to mieszkanie to nie tylko cztery ściany – to styl życia. Gotowe do zamieszkania od zaraz, bez dodatkowych nakładów, w lokalizacji, która nigdy nie straci na wartości. Idealne dla singla, pary albo jako inwestycja pod wynajem – krótko- i długoterminowy.Zadzwoń, umów się na prezentację i poczuj na własnej skórze, dlaczego Kolberga 12 to adres, w którym po prostu chce się mieszkać.', 'details': [{'offerDetailsKey': 'Powierzchnia:', 'offerDetailsValue': '45m²'}, {'offerDetailsKey': 'Liczba pokoi:', 'offerDetailsValue': '2'}, {'offerDetailsKey': 'Ogrzewanie:', 'offerDetailsValue': 'elektryczne'}, {'offerDetailsKey': 'Piętro:', 'offerDetailsValue': '2/4'}, {'offerDetailsKey': 'Czynsz:', 'offerDetailsValue': '320 zł'}, {'offerDetailsKey': 'Stan wykończenia:', 'offerDetailsValue': 'do zamieszkania'}, {'offerDetailsKey': 'Rynek:', 'offerDetailsValue': 'wtórny'}, {'offerDetailsKey': 'Forma własności:', 'offerDetailsValue': 'brak informacji'}, {'offerDetailsKey': 'Dostępne od:', 'offerDetailsValue': '2025-09-08'}, {'offerDetailsKey': 'Typ ogłoszeniodawcy:', 'offerDetailsValue': 'prywatny'}, {'offerDetailsKey': 'Informacje dodatkowe:', 'offerDetailsValue': 'balkonpiwnica'}, {'offerDetailsKey': 'Winda:', 'offerDetailsValue': 'nie'}, {'offerDetailsKey': 'Rodzaj zabudowy:', 'offerDetailsValue': 'kamienica'}, {'offerDetailsKey': 'Materiał budynku:', 'offerDetailsValue': 'cegła'}, {'offerDetailsKey': 'Okna:', 'offerDetailsValue': 'plastikowe'}, {'offerDetailsKey': 'Wyposażenie:', 'offerDetailsValue': 'meblepralkalodówkakuchenkatelewizor'}, {'offerDetailsKey': 'Zabezpieczenia:', 'offerDetailsValue': 'domofon / wideofon'}]}, 'url': 'https://www.otodom.pl/pl/oferta/mieszkanie-przy-rynku-kleparskim-w-niezlej-cenie-ID4y1qh'},{'data': {'price': '831 000 zł', 'price_m2': '18 467 zł/m²', 'address': 'Kleparz, Stare Miasto, Kraków, małopolskie', 'offerType': 'Oferta prywatna', 'description': 'Wyobraź sobie, że mieszkasz w samym sercu Krakowa – kilka kroków od Dworca Głównego, tuż obok tętniącego życiem Starego Miasta, a jednocześnie w miejscu, gdzie możesz złapać oddech i poczuć klimat dawnej krakowskiej kamienicy. To właśnie tutaj, przy ul. Kolberga 12, czeka na Ciebie mieszkanie, które łączy nowoczesność z historią.Wnętrze, które pachnie nowościąMieszkanie jest świeżo po remoncie i odświeżeniu – pachnie nowymi meblami i gotowe jest, by ktoś od razu się wprowadził.Oddzielna sypialnia – idealna na spokojny sen,Przytulny salon z narożnikiem, który po rozłożeniu zamienia się w dodatkowe miejsce do spania,Salon połączony z funkcjonalnym aneksem kuchennym, gdzie przygotujesz poranną kawę albo kolację dla przyjaciół,Łazienka i toaleta – osobne pomieszczenia, co w codziennym życiu okazuje się bezcenne,Dwie pojemne szafy, które pomieszczą wszystko, co chcesz ukryć przed światem.Gotowe do życiapłyta grzewcza, lodówka, okap, czajnik elektryczny,nowa pralka,pełne wyposażenie kuchni – od talerzy po garnki i sztućce,ogrzewanie? Oryginalne piece kaflowe z grzałkami – klimat dawnych wnętrz, ale w praktycznej wersji XXI wieku.Lokalizacja, która mówi sama za siebie5 minut spacerem do Dworca Głównego i Galerii Krakowskiej,kilka chwil i jesteś na Rynku Głównym,pełna komunikacja miejska – tramwaje i autobusy na wyciągnięcie ręki,w pobliżu sklepy, kawiarnie, restauracje i wszystko, czego potrzebujesz na co dzień,bliskość uczelni (UJ, Politechnika, UEK) – świetna opcja także pod inwestycję,Planty, parki i Bulwary Wiślane – idealne, żeby złapać balans między miejskim rytmem a chwilą oddechu.Dlaczego warto?Bo to mieszkanie to nie tylko cztery ściany – to styl życia. Gotowe do zamieszkania od zaraz, bez dodatkowych nakładów, w lokalizacji, która nigdy nie straci na wartości. Idealne dla singla, pary albo jako inwestycja pod wynajem – krótko- i długoterminowy.Zadzwoń, umów się na prezentację i poczuj na własnej skórze, dlaczego Kolberga 12 to adres, w którym po prostu chce się mieszkać.', 'details': [{'offerDetailsKey': 'Powierzchnia:', 'offerDetailsValue': '45m²'}, {'offerDetailsKey': 'Liczba pokoi:', 'offerDetailsValue': '2'}, {'offerDetailsKey': 'Ogrzewanie:', 'offerDetailsValue': 'elektryczne'}, {'offerDetailsKey': 'Piętro:', 'offerDetailsValue': '2/4'}, {'offerDetailsKey': 'Czynsz:', 'offerDetailsValue': '320 zł'}, {'offerDetailsKey': 'Stan wykończenia:', 'offerDetailsValue': 'do zamieszkania'}, {'offerDetailsKey': 'Rynek:', 'offerDetailsValue': 'wtórny'}, {'offerDetailsKey': 'Forma własności:', 'offerDetailsValue': 'brak informacji'}, {'offerDetailsKey': 'Dostępne od:', 'offerDetailsValue': '2025-09-08'}, {'offerDetailsKey': 'Typ ogłoszeniodawcy:', 'offerDetailsValue': 'prywatny'}, {'offerDetailsKey': 'Informacje dodatkowe:', 'offerDetailsValue': 'balkonpiwnica'}, {'offerDetailsKey': 'Winda:', 'offerDetailsValue': 'nie'}, {'offerDetailsKey': 'Rodzaj zabudowy:', 'offerDetailsValue': 'kamienica'}, {'offerDetailsKey': 'Materiał budynku:', 'offerDetailsValue': 'cegła'}, {'offerDetailsKey': 'Okna:', 'offerDetailsValue': 'plastikowe'}, {'offerDetailsKey': 'Wyposażenie:', 'offerDetailsValue': 'meblepralkalodówkakuchenkatelewizor'}, {'offerDetailsKey': 'Zabezpieczenia:', 'offerDetailsValue': 'domofon / wideofon'}]}, 'url': 'https://www.otodom.pl/pl/oferta/mieszkanie-przy-rynku-kleparskim-w-niezlej-cenie-ID4y1qh'},{'data': {'price': '831 000 zł', 'price_m2': '18 467 zł/m²', 'address': 'Kleparz, Stare Miasto, Kraków, małopolskie', 'offerType': 'Oferta prywatna', 'description': 'Wyobraź sobie, że mieszkasz w samym sercu Krakowa – kilka kroków od Dworca Głównego, tuż obok tętniącego życiem Starego Miasta, a jednocześnie w miejscu, gdzie możesz złapać oddech i poczuć klimat dawnej krakowskiej kamienicy. To właśnie tutaj, przy ul. Kolberga 12, czeka na Ciebie mieszkanie, które łączy nowoczesność z historią.Wnętrze, które pachnie nowościąMieszkanie jest świeżo po remoncie i odświeżeniu – pachnie nowymi meblami i gotowe jest, by ktoś od razu się wprowadził.Oddzielna sypialnia – idealna na spokojny sen,Przytulny salon z narożnikiem, który po rozłożeniu zamienia się w dodatkowe miejsce do spania,Salon połączony z funkcjonalnym aneksem kuchennym, gdzie przygotujesz poranną kawę albo kolację dla przyjaciół,Łazienka i toaleta – osobne pomieszczenia, co w codziennym życiu okazuje się bezcenne,Dwie pojemne szafy, które pomieszczą wszystko, co chcesz ukryć przed światem.Gotowe do życiapłyta grzewcza, lodówka, okap, czajnik elektryczny,nowa pralka,pełne wyposażenie kuchni – od talerzy po garnki i sztućce,ogrzewanie? Oryginalne piece kaflowe z grzałkami – klimat dawnych wnętrz, ale w praktycznej wersji XXI wieku.Lokalizacja, która mówi sama za siebie5 minut spacerem do Dworca Głównego i Galerii Krakowskiej,kilka chwil i jesteś na Rynku Głównym,pełna komunikacja miejska – tramwaje i autobusy na wyciągnięcie ręki,w pobliżu sklepy, kawiarnie, restauracje i wszystko, czego potrzebujesz na co dzień,bliskość uczelni (UJ, Politechnika, UEK) – świetna opcja także pod inwestycję,Planty, parki i Bulwary Wiślane – idealne, żeby złapać balans między miejskim rytmem a chwilą oddechu.Dlaczego warto?Bo to mieszkanie to nie tylko cztery ściany – to styl życia. Gotowe do zamieszkania od zaraz, bez dodatkowych nakładów, w lokalizacji, która nigdy nie straci na wartości. Idealne dla singla, pary albo jako inwestycja pod wynajem – krótko- i długoterminowy.Zadzwoń, umów się na prezentację i poczuj na własnej skórze, dlaczego Kolberga 12 to adres, w którym po prostu chce się mieszkać.', 'details': [{'offerDetailsKey': 'Powierzchnia:', 'offerDetailsValue': '45m²'}, {'offerDetailsKey': 'Liczba pokoi:', 'offerDetailsValue': '2'}, {'offerDetailsKey': 'Ogrzewanie:', 'offerDetailsValue': 'elektryczne'}, {'offerDetailsKey': 'Piętro:', 'offerDetailsValue': '2/4'}, {'offerDetailsKey': 'Czynsz:', 'offerDetailsValue': '320 zł'}, {'offerDetailsKey': 'Stan wykończenia:', 'offerDetailsValue': 'do zamieszkania'}, {'offerDetailsKey': 'Rynek:', 'offerDetailsValue': 'wtórny'}, {'offerDetailsKey': 'Forma własności:', 'offerDetailsValue': 'brak informacji'}, {'offerDetailsKey': 'Dostępne od:', 'offerDetailsValue': '2025-09-08'}, {'offerDetailsKey': 'Typ ogłoszeniodawcy:', 'offerDetailsValue': 'prywatny'}, {'offerDetailsKey': 'Informacje dodatkowe:', 'offerDetailsValue': 'balkonpiwnica'}, {'offerDetailsKey': 'Winda:', 'offerDetailsValue': 'nie'}, {'offerDetailsKey': 'Rodzaj zabudowy:', 'offerDetailsValue': 'kamienica'}, {'offerDetailsKey': 'Materiał budynku:', 'offerDetailsValue': 'cegła'}, {'offerDetailsKey': 'Okna:', 'offerDetailsValue': 'plastikowe'}, {'offerDetailsKey': 'Wyposażenie:', 'offerDetailsValue': 'meblepralkalodówkakuchenkatelewizor'}, {'offerDetailsKey': 'Zabezpieczenia:', 'offerDetailsValue': 'domofon / wideofon'}]}, 'url': 'https://www.otodom.pl/pl/oferta/mieszkanie-przy-rynku-kleparskim-w-niezlej-cenie-ID4y1qh'}]
        data_cleaner = DataCleaner(scrapped_data)
        cleaned_data = data_cleaner.start()
        a = 1
    except Exception as e:
        get_logger().error(f"Error in main: {e}")

    
if __name__ == "__main__":
    asyncio.run(main())




